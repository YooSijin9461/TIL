TIL0714

## 1. 오늘 배운것



# WebRTC



**WebRTC** (Web Real-Time Communication)는 웹 브라우저 간에 플러그인의 도움 없이 서로 통신할 수 있도록 설계된 API이다. W3C에서 제시된 초안이며, 음성 통화, 영상 통화, P2P 파일 공유 등으로 활용될 수 있다.

![확대이미지](https://cdn.comworld.co.kr/news/photo/201709/49320_31557_4833.png)

 P2P 연결에서는 속도와 보안, 효율성을 고려해야겠지만, WebRTC가 범용적으로 사용되기 위해서는 **다양한 플랫폼과 브라우저에서 접속하는 사용자들에게 동일한 사용자 경험을 제공하는 일**이 첫 번째일 것이다. 때문에 WebRTC에서 브라우저와 플랫폼 간 호환성은 가장 큰 숙제일 수밖에 없다.





### 장점 및 단점

1. 장점
   1. 지연없는 빠른 통신기술
   2. 플러그인이 없어서 추가적 개발 비용 절감
   3. 무료 코덱 사용으로 비용 절감
   4. P2P 형태의 기기간 Direct 통신 시 별도의 서버 기술의 불필요
   5. 다수의 웹컨퍼런싱 기술 무료 제공



2. 단점
   1. 지원하는 브라우저의 한계 : 구글 주도하에 크롬만 지원했으나, 최근 몇년사이에 MS Edge, 애플 오페라, 파이어폭스가 참여하고 있어 브라우저 제약은 현저히 줄어들고 있음. (이런 크로스 브라우징 이슈를 해결하기 위해서는 adapter.js 라이브러리를 함께 사용하는 것이 필수적이다. 이 라이브러리는 shim 패턴 및 폴리필을 이용해 다양한 브라우저에서 발생할 수 있는 크로스 브라우징 이슈를 사전에 처리해준다.)
   2. 방화벽 문제 : UDP 차단하는 방화벽 우회 방법 필요(STUN/TURN서버 추가 구축으로 타 네트워크간 통신과 TCP지원기술을 추가하여 방화벽 차단 문제를 해소하는 상용 서비스가 출시중)
   3. Signaling : Google API에는 Signaling이 미포함되어 직접 개발 구현 필요





##  과정

### P2P 절차

WebRTC는 P2P 방식의 커뮤니케이션이기 때문에 각각의 웹 브라우저는 다음과 같은 절차를 밟아야 한다.

1. 각 브라우저가 P2P 커뮤니케이션에 동의
2. 서로의 주소를 공유
3. 보안 사항 및 방화벽 우회
4. 멀티미디어 데이터를 실시간으로 교환



### 방화벽과 NAT 트래버셜

 일반적인 컴퓨터에는 공인 IP가 할당되어 있지 않다. 그 원인으로는 방화벽(Firewall), 여러 대의 컴퓨터가 하나의 공인 IP를 공유하는 NAT, 유휴 상태의 IP를 일시적으로 임대받는 DHCP 때문이다. 이 때문에 단순히 공인 IP만을 알아낸다고 해서, 특정한 사용자를 가리킬 수는 없다. 공인 IP뿐만 아니라 해당 네트워크에 연결된 사설 IP 주소까지 알아내야 특정한 사용자를 지정할 수 있게 된다.

 일반적으로는 라우터가 NAT 역할을 한다. 외부에서 접근하는 공인 IP와 포트 번호를 확인하여 현재 네트워크 내의 사설 IP들을 적절히 매핑시켜준다. 그러니까 어떤 브라우저 두 개가 서로 직접 통신을 하려면, 각자 현재 연결된 라우터의 공인 IP 주소와 포트를 먼저 알아내야 한다. 하지만 어떤 라우터들은 특정 주소나 포트와의 연결을 차단하는 방화벽 설정이 되어 있을 수도 있다. 이처럼 라우터를 통과해서 연결할 방법을 찾는 과정을 NAT 트래버셜(NAT traversal)이라고 한다.

